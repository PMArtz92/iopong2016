<!DOCTYPE html> 
<html>
<head>
  <title>Pong!</title> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> 
  <link href="pong.css" media="screen, print" rel="stylesheet" type="text/css" />
    <script src="jquery-1.12.3.js"></script>
</head> 
 
<body>



  <div id="sidebar">

    <h2>I/O  2016</h2>

    <div class='description'>
        <button id="st1">Start</button>
    </div>

  </div>
  <canvas id="game">
    <div id="unsupported">
      Sorry, this example cannot be run because your browser does not support the &lt;canvas&gt; element
    </div>
  </canvas>


  <script src="game.js" type="text/javascript"></script> 
  <script src="pong.js" type="text/javascript"></script>
  <script type="text/javascript">

  </script>
  <script src="http://localhost:3000/socket.io/socket.io.js"></script>

  <script>
      Game.ready(function() {
          Game.start('game', Pong);
          G = Game;



    var socket = io.connect('http://localhost:3000');
    socket.emit("add-user", {"username": "gameScreen"});

    // add user name when connected to the game serve
    $('#st1').click(function(){
        document.dispatchEvent(new CustomEvent("gameStart"));
    });
    socket.on("game_control_data", function(data){

      console.log(data.pressedKey);
      //document.dispatchEvent(new CustomEvent("p1DownPress"));
        if(data.pressedKey == 'p1DownPress'){
            document.dispatchEvent(new CustomEvent("p1DownPress"));
        }
        else if(data.pressedKey == 'p1DownRelease'){
            document.dispatchEvent(new CustomEvent("p1DownRelease"));
            console.log('sdkjhf');
        }
        else if(data.pressedKey == 'p1UpPress'){
            document.dispatchEvent(new CustomEvent("p1UpPress"));
            console.log('ttt');
        }
        else if(data.pressedKey == 'p1UpRelease'){
            document.dispatchEvent(new CustomEvent("p1UpRelease"));
            console.log('ttt');
        }
        else if(data.pressedKey == 'p2UpPress'){
            document.dispatchEvent(new CustomEvent("p2UpPress"));
            console.log('a1');
        }
        else if(data.pressedKey == 'p2UpRelease'){
            document.dispatchEvent(new CustomEvent("p2UpRelease"));
            console.log('a2');
        }
        else if(data.pressedKey == 'p2DownPress'){
            document.dispatchEvent(new CustomEvent("p2DownPress"));
            console.log('ttt');
        }
        else if(data.pressedKey == 'p2DownRelease'){
            document.dispatchEvent(new CustomEvent("p2DownRelease"));
            console.log('ttt');
        }

    });

    socket.on("stateChange", function(data){
      console.log(data);

    });

    $("#endGame").on("click", function(){
      socket.emit("buttonClickEvent","endGame");
      console.log("end Game");
      return false;
    });

      });
  </script>





</body> 
</html>
